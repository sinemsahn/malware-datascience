import pefile
from capstone import *
pe = pefile.PE("ircbot.exe")
entrypoint = pe.OPTIONAL_HEADER.AddressOfEntryPoint


entrypoint_address = entrypoint+pe.OPTIONAL_HEADER.ImageBase



binary_code = pe.get_memory_mapped_image()[entrypoint:entrypoint+100]


disassembler = Cs(CS_ARCH_X86,CS_MODE_32)


for instruction in disassembler.disasm(binary_code,entrypoint_address):
	print"%s\t%s"%(instruction.mnemonic, instruction.op_str)
